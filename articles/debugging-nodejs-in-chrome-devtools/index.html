<!DOCTYPE html><html lang="zh-hans"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="preload" href="/component---src-layouts-index-jsx-e17d1cdade99165e9c1b.js" as="script"/><link rel="preload" href="/component---src-templates-post-jsx-27507960f393b3d8c2a0.js" as="script"/><link rel="preload" href="/path---articles-debugging-nodejs-in-chrome-devtools-1ae116018973d3ab5fb1.js" as="script"/><link rel="preload" href="/app-ce8e4b3fd337573a0d0e.js" as="script"/><link rel="preload" href="/commons-7cb37f2b0a2b623ec715.js" as="script"/><script id="webpack-manifest">/*<![CDATA[*/window.webpackManifest={"231608221292675":"app-ce8e4b3fd337573a0d0e.js","213534597649335":"component---src-pages-index-jsx-9b362b19d21af3043465.js","213130420965792":"component---src-templates-post-jsx-27507960f393b3d8c2a0.js","144251824217401":"component---src-pages-about-jsx-5365d4b1da5ea3ee2b84.js","142542727794042":"component---src-pages-categories-jsx-74ada32d5d0ecb974cf6.js","36530248567819":"component---src-pages-tags-jsx-609b68aac3d93c34222e.js","60335399758886":"path----d78bdb878f502650c2d1.js","51327362515378":"path---pages-1-518280692bdd7195b4c4.js","75172246543703":"path---pages-2-a6b2b9581d3fdaf977f9.js","164426320885590":"path---pages-3-1bf3f8ce4a809498df0d.js","36634944603307":"path---articles-what-it-feels-like-to-be-an-open-source-maintainer-d786f51da4c46fdf642a.js","164200587751496":"path---articles-it-is-time-to-build-your-own-scaffolding-with-slush-d820c6c74510eeea07db.js","117983641054692":"path---articles-a-5-minute-intro-to-styled-components-273464376fa230a36cb8.js","16513869733262":"path---articles-the-hexagon-by-css-fd8f2cbffc79789b87f7.js","178847977130202":"path---articles-j-query-3-0-final-released-d0fdc93237ef2ca5e837.js","75756939860346":"path---articles-book-recommendations-fe9dd173e4e5ce15ad3f.js","124914417430499":"path---articles-debugging-nodejs-in-chrome-devtools-1ae116018973d3ab5fb1.js","34301039453723":"path---articles-gitbook-9b1eb76dcf3d9848a7ee.js","98604038800202":"path---articles-implicit-type-conversion-29f469d952944ee195d8.js","121789115640772":"path---articles-javascript-developer-survey-results-234df753fe46958e4e0f.js","243600728860970":"path---articles-fecs-07ca5c48ab57528785af.js","158670570114090":"path---articles-j-query-3-0-alpha-versions-released-9547056ae74288eee184.js","184434443672680":"path---articles-my-code-wars-01-7ded967e6514626ffeb6.js","199135633831551":"path---articles-jquery-3-the-next-generations-db987f7cad9d75651f40.js","207599336133362":"path---articles-strict-mode-in-javascript-65b25195dec4f899e78c.js","24097795858102":"path---articles-utf-8-to-b-64-4a7f810d05c854800f90.js","261146748432161":"path---articles-jade-01-b30523de65d8185c084c.js","136220283076007":"path---articles-jade-02-327489a8c1e97ab7e9be.js","181113214826314":"path---articles-jade-03-883492e3f2db2e17411b.js","259999442313309":"path---articles-jade-04-48fca55c9c42303ae3a1.js","16949292511778":"path---articles-hello-world-dfb86a57388604205b05.js","273950069227526":"path---about-040b0c063b4fa2f92c40.js","30875753179511":"path---categories-ee35c8b944e83d38b1a6.js","142629428675168":"path---index-375b6858892957b0a766.js","55702396619907":"path---tags-ee35c8b944e83d38b1a6.js","79611799117203":"component---src-layouts-index-jsx-e17d1cdade99165e9c1b.js"}/*]]>*/</script><title data-react-helmet="true">在 Chrome 开发者工具中调试 node.js - 由作者根号三发布于 2016-02-29</title><link data-react-helmet="true" rel="stylesheet" href="https://cdn.bootcss.com/github-markdown-css/2.10.0/github-markdown.min.css"/><meta data-react-helmet="true" name="keyword" content="前端 前端工程师 HTML5 CSS3 Javascript React Vue Node.js Go Docker"/><meta data-react-helmet="true" name="description" content="web 开发者, 擅长各项前端技能，深入研究 web 端开发与前端性能, 并对 Nodejs 及 Go 服务端技术栈有深入了解。"/><script data-react-helmet="true" async="" src="https://www.googletagmanager.com/gtag/js?id=UA-64863915-1"></script><script data-react-helmet="true">
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-64863915-1');
        </script><script>/*<![CDATA[*/!function(e,t,r){function n(){for(;d[0]&&"loaded"==d[0][f];)c=d.shift(),c[o]=!i.parentNode.insertBefore(c,i)}for(var s,a,c,d=[],i=e.scripts[0],o="onreadystatechange",f="readyState";s=r.shift();)a=e.createElement(t),"async"in i?(a.async=!1,e.head.appendChild(a)):i[f]?(d.push(a),a[o]=n):e.write("<"+t+' src="'+s+'" defer></'+t+">"),a.src=s}(document,"script",["/commons-7cb37f2b0a2b623ec715.js","/app-ce8e4b3fd337573a0d0e.js","/path---articles-debugging-nodejs-in-chrome-devtools-1ae116018973d3ab5fb1.js","/component---src-templates-post-jsx-27507960f393b3d8c2a0.js","/component---src-layouts-index-jsx-e17d1cdade99165e9c1b.js"])/*]]>*/</script><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/css/bootstrap.min.css"/><style id="gatsby-inlined-css">.navbar-custom .nav-link,.navbar-custom .navbar-brand{font-weight:700;color:#fff}.navbar-custom .nav-item{margin:0 8px}.nav-link:hover{color:#ccc}.navbar-custom{transition:.3s;-webkit-transform:translateZ(0);transform:translateZ(0);-webkit-backface-visibility:hidden;backface-visibility:hidden}.navbar-custom.fixed-top{top:-60px}.navbar-custom.navbar--is-on-top{top:0}.navbar-custom.navbar--is-visible{top:0;background-color:hsla(0,0%,100%,.90196);box-shadow:0 0 40px rgba(0,0,0,.2)}.navbar-custom.navbar--is-visible .nav-link,.navbar-custom.navbar--is-visible .navbar-brand{color:#3d464d}.footer{padding:2em 0;margin-top:50px;font-size:12px;color:#999;background-color:#000}.footer ul{padding-left:0;list-style:none}.footer li{padding:24px 2em;line-height:1.8}.footer h2{font-size:14px;margin:0 auto 8px;font-weight:500}.footer a{color:#fff;cursor:pointer}.footer strong{font-weight:400}.intro-header{padding:150px 0;margin-bottom:32px;background:no-repeat 50%;background-size:cover;background-image:linear-gradient(120deg,#2b488a,#ca3749)}.intro-header__site-heading{font-size:80px;color:#fff}.intro-header__subheading{font-size:18px;color:#fff}.intro-header--small{padding:80px 0}.intro-header--small .intro-header__site-heading{font-size:48px}.post{padding:24px 8px;border-bottom:1px solid rgba(0,0,0,.10196)}.post__link{display:block}.post__link:hover{text-decoration:none}.post__link:hover .post__title{color:#366df0}.post__title{margin-bottom:.6em;font-size:26px;line-height:1.2;color:#3d464d}.post__title:hover{color:#366df0}.post__content-preview{font-size:14px;text-align:justify;color:#a3a3a3}.post__meta{margin-top:8px;margin-bottom:0;font-size:14px;color:#a3a3a3}.post--small .post__title{font-size:18px}.post--succinct .post__content-preview{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.post--succinct .post__meta{display:none}.post--succinct .post__link:hover .post__content-preview,.post--succinct .post__link:hover .post__title{color:#366df0}.tag{display:inline-block;border:1px solid #bfbfbf;margin-right:.6em;margin-bottom:.6em;border-radius:999em;font-size:12px;line-height:24px}.tag:last-child{margin-right:0}.tag__link{display:block;padding:0 1em;color:#bfbfbf;text-decoration:none}.tag:hover{border-color:#0056b3}.tag:hover .tag__link{color:#0056b3;text-decoration:none}.tag--full:hover{border-color:#0056b3;background-color:#0056b3}.tag--full:hover .tag__link{color:#fff;text-decoration:none}.tag--white{border-color:#fff}.tag--white .tag__link{color:#fff}.tag--white.tag--full:hover{border-color:hsla(0,0%,100%,.4);background-color:hsla(0,0%,100%,.4)}.tag--white.tag--full:hover .tag__link{color:#fff;text-decoration:none}.tag--custom-color .tag__link{color:#fff!important}.section{border-bottom:1px solid rgba(0,0,0,.10196);margin-bottom:24px}.section:last-child{border-bottom:none}.section__title{padding-bottom:8px;font-size:16px;font-weight:700;text-transform:uppercase;color:gray}.section__title a{color:gray;text-decoration:none}.section__body{padding-bottom:16px}.short-about__avatar{width:100%;height:auth}.short-about__intro{margin:16px 0;font-size:14px;color:#bfbfbf}.sns{margin-bottom:0}.sns__link{color:#bfbfbf}.friend-links{margin:0}.friend-links__link{font-size:14px;color:#bfbfbf}.src-styles----post-module---post-heading---3XY_J{padding:150px 0;background:no-repeat 50%;background-color:gray;background-size:cover;background-image:linear-gradient(120deg,#2b488a,#ca3749)}.src-styles----post-module---post-heading__title---1-9YQ{margin:16px 0;font-size:54px;color:#fff}.src-styles----post-module---post-heading__meta---3katd{color:#fff}.markdown-body{margin:48px 0}.src-styles----post-module---donation---1rPSR{padding:30px 0;border-top:1px solid #eee;border-bottom:1px solid #eee;text-align:center}.social-share{margin:24px 0}.src-styles----post-module---pager---3ag2f{margin-top:32px}.src-styles----post-module---pager__item---vNI-Q{display:block;padding:16px 24px;font-size:14px;border:1px solid #ddd;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,PingFang SC,Hiragino Sans GB,Microsoft YaHei,SimSun,sans-serif;line-height:1.6;text-transform:uppercase;letter-spacing:1px;color:#404040;background-color:#fff}.src-styles----post-module---pager__item---vNI-Q:hover{color:#404040;background:#eceeef;text-decoration:none}.src-styles----post-module---pager__title---2ZGsj{font-weight:700}.src-styles----post-module---pager__tips---R2YkG{margin:0;color:gray}.src-styles----post-module---pager__item--disabled---XSQC6{color:#818a91;cursor:not-allowed;background-color:#fff}.src-styles----post-module---pager__item--disabled---XSQC6:hover{color:#818a91;background-color:#fff}.markdown-body .highlight{position:relative;padding-top:38px;border-radius:6px;background-color:#21252b}.markdown-body .highlight:before{position:absolute;top:0;left:0;float:left;width:100%;height:38px;content:attr(rel);padding:0 80px;line-height:38px;font-size:16px;font-family:Source Sans Pro,sans-serif;font-weight:700;text-indent:15px;color:#fff}.markdown-body .highlight:after{position:absolute;top:0;left:20px;width:12px;height:12px;content:" ";margin-top:13px;box-shadow:20px 0 #fdbc40,40px 0 #35cd4b;border-radius:50%;background:#fc625d}.markdown-body .highlight pre{background-color:#2d2d2d!important;color:#ccc;counter-reset:line-number -1}.markdown-body .highlight pre .line{line-height:20px;background-color:#2d2d2d;color:#ccc;counter-increment:line-number}.markdown-body .highlight pre .line:before{display:inline-block;width:30px;margin-right:8px;content:counter(line-number)}.tagCloud{margin:32px 0}.post-block__heading{font-size:20px;color:#0085a1}.post-block__title{margin-left:6px;font-weight:300;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,PingFang SC,Hiragino Sans GB,Microsoft YaHei,SimSun,sans-serif;line-height:1.7}.post-block__body{margin-left:16px;margin-bottom:24px}</style></head><body><div id="___gatsby"><div data-reactroot="" data-reactid="1" data-react-checksum="671869816"><nav class="navbar navbar-expand-sm fixed-top navbar-custom navbar--is-on-top" data-reactid="2"><div class="container" data-reactid="3"><div class="collapse navbar-collapse justify-content-between" data-reactid="4"><a class="navbar-brand" href="/" data-reactid="5">根号三</a><ul class="nav navbar-nav navbar-right text-uppercase" data-reactid="6"><li class="nav-item" data-reactid="7"><a class="nav-link" href="/categories/" data-reactid="8">categories</a></li><li class="nav-item" data-reactid="9"><a class="nav-link" href="/tags/" data-reactid="10">Tags</a></li><li class="nav-item" data-reactid="11"><a class="nav-link" href="/about" data-reactid="12">about</a></li><li class="nav-item" data-reactid="13"><a class="nav-link" href="https://github.com/sqrthree/lite" target="_blank" data-reactid="14">GitHub</a></li></ul></div></div></nav><div data-reactid="15"><!-- react-empty: 16 --><div class="src-styles----post-module---post-heading---3XY_J" data-reactid="17"><div class="container" data-reactid="18"><div class="row justify-content-md-center" data-reactid="19"><div class="col-10" data-reactid="20"><div class="tags ghost-tags" data-reactid="21"><div class="tag tag--full tag--white" data-reactid="22"><a class="tag__link" href="/tags#译文" data-reactid="23">译文</a></div></div><h1 class="src-styles----post-module---post-heading__title---1-9YQ" data-reactid="24">在 Chrome 开发者工具中调试 node.js</h1><p class="src-styles----post-module---post-heading__meta---3katd" data-reactid="25"><!-- react-text: 26 -->根号三<!-- /react-text --><!-- react-text: 27 --> · <!-- /react-text --><!-- react-text: 28 -->2016-02-29<!-- /react-text --></p></div></div></div></div><div class="container" data-reactid="29"><div class="row justify-content-md-center" data-reactid="30"><div class="col-10" data-reactid="31"><article class="markdown-body" data-reactid="32"><blockquote>
<ul>
<li>原文链接 : <a href="http://mattdesl.svbtle.com/debugging-nodejs-in-chrome-devtools">Debugging Node.js in Chrome DevTools</a></li>
<li>原文作者 : <a href="http://mattdesl.svbtle.com/">MATT DESLAURIERS</a></li>
<li>译文出自 : <a href="https://github.com/xitu/gold-miner">掘金翻译计划</a></li>
<li>译者 : <a href="https://github.com/sqrthree">sqrthree (根号三)</a></li>
<li>校对者: <a href="https://github.com/shenxn">shenxn</a>、<a href="https://github.com/CoderBOBO">CoderBOBO</a></li>
</ul>
</blockquote>
<p>这篇文章介绍了一种在 Chrome 开发者工具里面开发、调试和分析 Node.js 应用程序的新方法。</p>
<h2>devtool</h2>
<p>最近我一直在开发一个命令行工具 <a href="https://github.com/Jam3/devtool">devtool</a>，它可以在 Chrome 的开发者工具中运行 Node.js 程序。</p>
<p>下面的记录显示了在一个 HTTP 服务器中设置断点的情况。</p>
<p><img src="https://camo.githubusercontent.com/50a1b83c05a2995479bb27d913e12b6f25557f2c/687474703a2f2f692e696d6775722e636f6d2f56345251535a322e676966" alt="movie"></p>
<p>该工具基于 <a href="https://github.com/atom/electron/">Electron</a> 将 Node.js 和 Chromium 的功能融合在了一起。它的目的在于为调试、分析和开发 Node.js 应用程序提供一个简单的界面。</p>
<p>你可以使用 <a href="http://npmjs.com/">npm</a> 来安装它:</p>
<div class='highlight'><pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>npm&nbsp;install&nbsp;-g&nbsp;devtool</span></span></div></pre></div>
<h2>REPL</h2>
<p>在某种程度上，我们可以用它来作为 <code>node</code> shell 命令的替代品。例如，我们可以这样打开一个 REPL (译者注: REPL 全称为"Read-Eval-Print Loop"，是一个简单的、交互式的编程环境)。</p>
<div class='highlight'><pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>devtool</span></span></div></pre></div>
<p>这将启动一个带有 Node.js 特性支持的 Chrome 开发者工具实例。</p>
<p><img src="https://camo.githubusercontent.com/fa9fa900ca1aa0e35a5bbc41461212b98a0dfb82/687474703a2f2f692e696d6775722e636f6d2f626e496e4248412e706e67" alt="console"></p>
<p>我们可以引用 Node 模块、本地 npm 模块和像 <code>process.cwd()</code> 这样的内置模块。也可以获取像 <code>copy()</code> 和 <code>table()</code> 这样的 Chrome 开发者工具中的函数。</p>
<p>其他的例子就一目了然了:</p>
<div class='highlight'><pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>#&nbsp;run&nbsp;a&nbsp;Node&nbsp;script</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>devtool&nbsp;app.js</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>#&nbsp;pipe&nbsp;in&nbsp;content&nbsp;to&nbsp;process.stdin</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>devtool&nbsp;&lt;&nbsp;audio.mp3</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>#&nbsp;pipe&nbsp;in&nbsp;JavaScript&nbsp;to&nbsp;eval&nbsp;it</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>browserify&nbsp;index.js&nbsp;|&nbsp;devtool</span></span></div></pre></div>
<h2>开发</h2>
<p>我们可以在通用模块和应用程序的开发中使用 <code>devtool</code>，来代替像 <a href="https://www.npmjs.com/package/nodemon">nodemon</a> 这样目前已经存在的工具。</p>
<div class='highlight'><pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>devtool&nbsp;app.js&nbsp;--watch</span></span></div></pre></div>
<p>这行命令将会在 Chrome 开发者工具中的控制台中启动我们的 <code>app.js</code>， 通过 <code>--watch</code> 参数，我们保存的文件将(自动)重新载入到控制台。</p>
<p><img src="https://camo.githubusercontent.com/f7e562cdf408b8e1069be5cdc5492844a0216cb3/687474703a2f2f692e696d6775722e636f6d2f4e756f596b4a4b2e706e67" alt="console"></p>
<p>点击 <a href="http://mattdesl.svbtle.com/debugging-nodejs-in-chrome-devtools"><code>app.js:1</code></a> 链接，程序将会在 <code>Sources</code> 标签中把我们带到与之相关的那一行。</p>
<p><img src="https://camo.githubusercontent.com/82226fac41ca329e865755aaf8191ac228a37d9c/687474703a2f2f692e696d6775722e636f6d2f6d48356a5754392e706e67" alt="line"></p>
<p>在 <code>Sources</code> 标签中，你也可以敲击 <code>Cmd/Ctrl + P</code> 按键在所有依赖的模块中进行快速搜索。你甚至可以审查和调试内置模块，比如 Node.js 中的那些。你也可以使用左手边的面板来浏览模块。</p>
<p><img src="https://camo.githubusercontent.com/8ea6bc50f269412d83761d60d24c8be3e53df953/687474703a2f2f692e696d6775722e636f6d2f6a6e33526d6e562e706e67" alt="Sources"></p>
<h2>调试</h2>
<p>因为我们能够访问 <code>Sources</code> 标签，所以我们可以用它来调试我们的应用程序。你可以设置一个断点，然后重新加载调试器(<code>Cmd/Ctrl + R</code>)，或者你也可以通过 <code>--break</code> 标记来设置一个初始断点。</p>
<div class='highlight'><pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>devtool&nbsp;app.js&nbsp;--break</span></span></div></pre></div>
<p><img src="https://camo.githubusercontent.com/a7f94f291fd37eb55e7506535f7cb33005dfb3a5/687474703a2f2f692e696d6775722e636f6d2f684a32704c57312e706e67" alt="break"></p>
<p>下面是一些对于那些学习 Chrome 开发者工具的人来说可能不是特别常用的功能:</p>
<ul>
<li><a href="http://blittle.github.io/chrome-dev-tools/sources/conditional-breakpoints.html">条件断点</a></li>
<li><a href="http://blittle.github.io/chrome-dev-tools/sources/uncaught-exceptions.html">有未捕获的异常时暂停</a></li>
<li><a href="http://blittle.github.io/chrome-dev-tools/sources/restart-frame.html">重启帧</a></li>
<li><a href="http://albertlee.azurewebsites.net/using-watch-tools-in-chrome-dev-tools-to-improve-your-debugging/">监听表达式</a></li>
</ul>
<blockquote>
<p>提示 - 当调试器暂停时，你可以敲击 <code>Escape</code> 按键打开一个执行在当前作用域内的控制台。你可以修改一些变量然后继续执行。</p>
</blockquote>
<p><img src="https://camo.githubusercontent.com/9ee842372ed3c1374fe25e41128f1f13979f2b30/687474703a2f2f692e696d6775722e636f6d2f6e4739656c6c452e676966" alt="Imgur"></p>
<h2>分析</h2>
<p><code>devtool</code> 的另一个功能是分析像 <a href="https://github.com/substack/node-browserify">browserify</a>, <a href="https://github.com/gulpjs/gulp">gulp</a> 和 <a href="https://github.com/babel/babel">babel</a> 这样的程序。</p>
<p>这里我们使用 <a href="https://developer.chrome.com/devtools/docs/console-api"><code>console.profile()</code></a> (Chrome 的一个功能)来分析一个打包工具的 CPU 使用情况。</p>
<div class='highlight'><pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>var&nbsp;browserify&nbsp;=&nbsp;require(&#39;browserify&#39;);</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>//&nbsp;Start&nbsp;DevTools&nbsp;profiling...</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>console.profile(&#39;build&#39;);</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>//&nbsp;Bundle&nbsp;some&nbsp;browser&nbsp;application</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>browserify(&#39;client.js&#39;).bundle(function&nbsp;(err,&nbsp;src)&nbsp;{</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(err)&nbsp;throw&nbsp;err;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Finish&nbsp;DevTools&nbsp;profiling...</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;console.profileEnd(&#39;build&#39;);</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>});</span></span></div></pre></div>
<p>现在我们在这个文件上运行 <code>devtool</code> :</p>
<div class='highlight'><pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>devtool&nbsp;app.js</span></span></div></pre></div>
<p>执行之后，我们可以在 <code>Profiles</code> 标签中看到结果。</p>
<p><img src="https://camo.githubusercontent.com/b677a18d13fdd723cb71e86d37122343453700b5/687474703a2f2f692e696d6775722e636f6d2f765375374c637a2e706e67" alt="profile"></p>
<p>我们可以使用右边的链接来查看和调试执行频率较高的代码路径。</p>
<p><img src="https://camo.githubusercontent.com/f5410d64be4b7074c9e0c7d6c0e3a79fbd0d1931/687474703a2f2f692e696d6775722e636f6d2f4f34445a4879762e706e67" alt="debug"></p>
<h2>高级选项</h2>
<h4>实验</h4>
<p>Chrome 会不断的向他们的开发者工具中推送新功能和实验，例如 <strong>Promise Inspector</strong>。你可以通过点击右上角的三个点，然后选择 <code>Settings -> Experiments</code> 来开启他们。</p>
<p><img src="https://camo.githubusercontent.com/cc94d6b2c496c78fa1c1a854e82ff718b0ba461d/687474703a2f2f692e696d6775722e636f6d2f644e75494d77302e706e67" alt="experiments"></p>
<p>一旦启用，你就可以通过敲击 <code>Escape</code> 按键来调出一个带有 <code>Promises</code> 监视器的面板。</p>
<p><img src="https://camo.githubusercontent.com/6a5559e67609cada5ce00a71ccd16437110d1974/68747470733a2f2f692e696d6775722e636f6d2f784b6b544565672e706e67"></p>
<blockquote>
<p>提示: 在 <em>Experiments</em> 界面，如果你敲击 <code>Shift</code> 键 6 次，你会接触到一些甚至更多的实验性（不稳定）的功能。</p>
</blockquote>
<h4><a href="http://mattdesl.svbtle.com/debugging-nodejs-in-chrome-devtools#codeconsolecode"> </a><code>--console</code></h4>
<p>你可以重定向控制台输出到终端中(<code>process.stdout</code> 和 <code>process.stderr</code>)。也允许你通过使用管道将它导入到其他进程中，例如 TAP prettifiers。</p>
<div class='highlight'><pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>devtool&nbsp;test.js&nbsp;--console&nbsp;|&nbsp;tap-spec</span></span></div></pre></div>
<h4><code>--</code> 和 <code>process.argv</code></h4>
<p>你的脚本可以像一个普通的 Node.js 应用那样解析 <code>process.argv</code>。如果你在 <code>devtool</code> 命令中传递一个句号(<code>--</code>)，它后面的所有内容都会被当做一个新的 <code>process.argv</code> 。例如:</p>
<div class='highlight'><pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>devtool&nbsp;script.js&nbsp;--console&nbsp;--&nbsp;input.txt</span></span></div></pre></div>
<p>现在，你的脚本看起来像这样:</p>
<div class='highlight'><pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>var&nbsp;file&nbsp;=&nbsp;process.argv[2];</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>console.log(&#39;File:&nbsp;%s&#39;,&nbsp;file);</span></span></div></pre></div>
<p>输出:</p>
<div class='highlight'><pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>File:&nbsp;input.txt</span></span></div></pre></div>
<h4>--quit<code>和</code>--headless`</h4>
<p>使用 <code>--quit</code>，当遇到了一个错误(如语法错误或者未捕获的异常)时，进程将会安静的退出，并返回结束码<code>1</code> 。</p>
<p>使用 <code>--headless</code>，开发工具将不会被打开。</p>
<p>这可以用于命令行脚本：</p>
<div class='highlight'><pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>devtool&nbsp;render.js&nbsp;--quit&nbsp;--headless&nbsp;&gt;&nbsp;result.png</span></span></div></pre></div>
<h4>)<code>--browser-field</code></h4>
<p>一些模块为了更好的在浏览器中运行或许会提供一个入口点。当你需要这些模块时，你可以使用 <code>--browser-field</code> 来支持 <a href="https://github.com/defunctzombie/package-browser-field-spec">package.json flag</a></p>
<p>例如，我们可以使用 <a href="https://github.com/Jam3/xhr-request">xhr-request</a> ，当带有 <code>"browser"</code> 字段被引用时，这个模块会使用 XHR。</p>
<div class='highlight'><pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>const&nbsp;request&nbsp;=&nbsp;require(&#39;xhr-request&#39;);</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>request(&#39;</span><span class="syntax--markup syntax--underline syntax--link syntax--https syntax--hyperlink"><span>https://api.github.com/users/mattdesl/repos</span></span><span>&#39;,&nbsp;{</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;json:&nbsp;true</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>},&nbsp;(err,&nbsp;data)&nbsp;=&gt;&nbsp;{</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(err)&nbsp;throw&nbsp;err;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;console.log(data);</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>});</span></span></div></pre></div>
<p>在 shell 中执行:</p>
<div class='highlight'><pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>npm&nbsp;install&nbsp;xhr-request&nbsp;--save</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>devtool&nbsp;app.js&nbsp;--browser-field</span></span></div></pre></div>
<p>现在，我们可以在 <code>Network</code> 选项卡中审查请求:</p>
<p><img src="https://camo.githubusercontent.com/a5007beaedc3e343ae9babc410f76fd02786be47/687474703a2f2f692e696d6775722e636f6d2f425763695875682e706e67" alt="requests"></p>
<h4><code>--no-node-timers</code></h4>
<p>默认情况下，我们提供全局的 <code>setTimeout</code> and <code>setInterval</code>，因此他们表现的像 Node.js 一样(返回一个带有 <code>unref()</code> and <code>ref()</code> 函数的对象)。</p>
<p>但是，你可以禁用这个方法来改善对异步堆栈跟踪的支持。</p>
<div class='highlight'><pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>devtool&nbsp;app.js&nbsp;--no-node-timers</span></span></div></pre></div>
<p><img src="https://camo.githubusercontent.com/890fc0aa560702a16b8f6ff97f02551208696a59/687474703a2f2f692e696d6775722e636f6d2f646d664f664d782e706e67" alt="async"></p>
<h4>V8 Flags</h4>
<p>在当前目录，你可以创建一个 <code>.devtoolrc</code> 文件来进行诸如 V8 flags 这样的高级设置。</p>
<div class='highlight'><pre class="editor editor-colors"><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>{</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>&nbsp;&nbsp;&quot;v8&quot;:&nbsp;{</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&quot;flags&quot;:&nbsp;[</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;--harmony-destructuring&quot;</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>&nbsp;&nbsp;&nbsp;&nbsp;]</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>&nbsp;&nbsp;}</span></span></div><div class="line"><span class="syntax--text syntax--plain syntax--null-grammar"><span>}</span></span></div></pre></div>
<p>访问 <a href="https://github.com/Jam3/devtool/blob/master/docs/rc-config.md">这里</a> 获取更多细节</p>
<h2>陷阱</h2>
<p>由于程序是在一个 Browser/Electron 环境中运行，而不是在一个真正的 Node.js 环境中。因此这里有<a href="https://github.com/Jam3/devtool#gotchas">一些陷阱</a>你需要注意。</p>
<h2>对比</h2>
<p>目前已经存在了一些 Node.js 调试器，所以你或许想知道他们之间的区别在哪。</p>
<h3>WebStorm 调试器</h3>
<p><a href="https://www.jetbrains.com/webstorm/">WebStorm</a> 编辑器里面包含了一个非常强大的 Node.js 调试器。如果你已经使用 WebStorm 作为你的代码编辑器，那对你来说很棒。</p>
<blockquote>
<p><img src="https://camo.githubusercontent.com/97481997c2175c1c6f8f490c030f0cb9b668ddc3/68747470733a2f2f692e696d6775722e636f6d2f636677473671592e706e67"></p>
</blockquote>
<p>但是，它缺少一些 Chrome 开发者工具中的功能，例如:</p>
<ul>
<li>一个丰富的互动的控制台</li>
<li>异常时暂停</li>
<li>异步堆栈跟踪</li>
<li>Promise 检查</li>
<li>分析</li>
</ul>
<p>但因为你和你的 WebStorm 工作空间集成，所以你可以在调试时修改和编辑你的文件。它也是运行在一个真正的 Node/V8 环境中，而不像 <code>devtool</code> 一样。因此对于大部分的 Node.js 应用程序来说它更稳健。</p>
<h3>iron-node</h3>
<p><img src="https://camo.githubusercontent.com/974568a8cc4d0604c9798aebfc6e32a401be0ec6/68747470733a2f2f692e696d6775722e636f6d2f666b624c766f532e706e67"></p>
<p>一个同样基于 Electron 的调试器是<a href="https://github.com/s-a/iron-node">iron-node</a>。<code>iron-node</code> 包含了一个内置的命令来重新编译原生插件，还有一个复杂的图形界面显示您的<code>package.json</code> 和 <code>README.md</code>。</p>
<p>而 <code>devtool</code> 更侧重于把命令行、Unix 风格的管道和重定向和 Electron/Browser 的 API 当作有趣的用例。</p>
<p><code>devtool</code> 提供各种各样的功能来表现的更像 Node.js (例如 <code>require.main</code>, <code>setTimeout</code> 和 <code>process.exit</code>)，并且覆盖了内部的 <code>require</code> 机制作为 source maps，还有改进过的错误处理、断点注入、以及 <code>"browser"</code> 字段的解决方案。</p>
<h3>node-inspector</h3>
<p><img src="https://camo.githubusercontent.com/874553b465d9ebaa46c6a30bada328fc31655e66/68747470733a2f2f692e696d6775722e636f6d2f54346670786a552e706e67"></p>
<p>你或许也喜欢 <a href="https://github.com/node-inspector/node-inspector">node-inspector</a>，一个使用远程调试而不是构建在 Electron 之上的工具。</p>
<p>这意味着你的代码将运行在一个真正的 Node 环境中，没有任何 <code>window</code> 或其他的 Browser/Electron API 来污染作用域并导致某些模块出现问题。对于大型 Node.js 应用(即本地插件)来说它有一个强有力的支持，并且在开发者工具实例中拥有更多的控制权(即可以注入断点和支持网络请求)。</p>
<p>然而，由于它重新实现了大量的调试技巧，因此对于开发来说感觉可能比最新版的 Chrome 开发者工具要慢、笨拙和脆弱。它经常会崩溃，往往导致 Node.js 开发人员很无奈。</p>
<p>而 <code>devtool</code> 的目的是让那些从 Chrome 开发者工具中转过来的人觉得比较亲切，而且也增加了像 Browser/Electron APIs 这样的功能。</p>
<blockquote>
<p>本文根据 <a href="http://mattdesl.svbtle.com/">MATT DESLAURIERS</a> 的《<a href="http://mattdesl.svbtle.com/debugging-nodejs-in-chrome-devtools">Debugging Node.js in Chrome DevTools</a>》所译，整个译文带有自己的理解与思想，如果译得不好或有不对之处还请同行朋友指点。如需转载此译文，需注明英文出处：<a href="http://mattdesl.svbtle.com/debugging-nodejs-in-chrome-devtools">Debugging Node.js in Chrome DevTools</a></p>
</blockquote></article><div class="src-styles----post-module---donation---1rPSR" data-reactid="33"><h3 class="mb-3" data-reactid="34">您的鼓励是作者写作最大的动力</h3><p data-reactid="35">如果您认为本网站的文章质量不错，读后觉得收获很大，不妨请我喝杯咖啡，让我有动力继续写出高质量的文章。: )</p><a href="http://7xl8me.com1.z0.glb.clouddn.com/alipay.JPG" class="btn btn-primary mr-2" target="_blank" data-reactid="36">支付宝打赏</a><a href="http://7xl8me.com1.z0.glb.clouddn.com/wechat_receive_money.JPG" class="btn btn-success" target="_blank" data-reactid="37">微信打赏</a></div><div class="social-share" data-disabled="diandian" data-reactid="38"></div><hr data-reactid="39"/><ul class="src-styles----post-module---pager---3ag2f row justify-content-between text-center list-inline" data-reactid="40"><li class="col list-inline-item" data-reactid="41"><a class="src-styles----post-module---pager__item---vNI-Q undefined" title="前端开发书籍推荐目录" href="/articles/book-recommendations/" data-reactid="42"><div class="src-styles----post-module---pager__title---2ZGsj" data-reactid="43">Previous</div><p class="src-styles----post-module---pager__tips---R2YkG" data-reactid="44">前端开发书籍推荐目录</p></a></li><li class="col list-inline-item" data-reactid="45"><a class="src-styles----post-module---pager__item---vNI-Q undefined" title="GitBook 简明教程" href="/articles/gitbook/" data-reactid="46"><div class="src-styles----post-module---pager__title---2ZGsj" data-reactid="47">Next</div><p class="src-styles----post-module---pager__tips---R2YkG" data-reactid="48">GitBook 简明教程</p></a></li></ul></div></div></div></div><footer class="footer" data-reactid="49"><div class="container" data-reactid="50"><div data-reactid="51"><ul class="row" data-reactid="52"><li class="col-md-3" data-reactid="53"><h2 data-reactid="54">友情链接</h2><div data-reactid="55"><a href="https://github.com/sqrthree" target="_blank" data-reactid="56">GitHub</a></div><div data-reactid="57"><a href="https://zhuanlan.zhihu.com/FETalk" target="_blank" data-reactid="58">FETalk</a></div></li><li class="col-md-3" data-reactid="59"><h2 data-reactid="60">Open Source</h2><div data-reactid="61"><a href="https://github.com/sqrthree/sqrthree.github.io" target="_blank" data-reactid="62">sqrthree.github.io</a></div><div data-reactid="63"><a href="https://github.com/sqrthree/awesome-npm-packages" target="_blank" data-reactid="64">awesome-npm-packages</a></div><div data-reactid="65"><a href="https://github.com/sqrthree/comeon" target="_blank" data-reactid="66">comeon</a></div><div data-reactid="67"><a href="https://github.com/sqrthree/lite" target="_blank" data-reactid="68">lite</a></div></li><li class="col-md-3" data-reactid="69"><h2 data-reactid="70">联系方式</h2><div data-reactid="71"><a href="javascript:;" data-reactid="72">Wechat</a><!-- react-text: 73 --> - <!-- /react-text --><!-- react-text: 74 -->511249910<!-- /react-text --></div><div data-reactid="75"><a href="javascript:;" data-reactid="76">Mail</a><!-- react-text: 77 --> - <!-- /react-text --><!-- react-text: 78 -->imsqrtthree@gmail.com<!-- /react-text --></div></li><li class="col-md-3" data-reactid="79"><h2 data-reactid="80">内容许可</h2><div data-reactid="81"><!-- react-text: 82 -->除特别说明外，本站所有内容均采用 <!-- /react-text --><a href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh" target="_blank" data-reactid="83">署名-非商业性使用-禁止演绎 4.0 国际 (CC BY-NC-ND 4.0)</a><!-- react-text: 84 --> 进行许可。<!-- /react-text --></div></li></ul></div><p class="text-md-right" data-reactid="85"><strong data-reactid="86"><!-- react-text: 87 -->©2018 <!-- /react-text --><a href="https://github.com/sqrthree" target="_blank" data-reactid="88">根号三 </a></strong><strong data-reactid="89"><!-- react-text: 90 -->Theme by <!-- /react-text --><a href="http://huangxuan.me/" target="_blank" data-reactid="91">Hux </a></strong><strong data-reactid="92"><!-- react-text: 93 -->Power by <!-- /react-text --><a href="https://www.gatsbyjs.org/" target="_blank" data-reactid="94">Gatsby</a></strong></p></div></footer><!-- react-empty: 95 --></div></div></body></html>